<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Information</title>
  <link rel="stylesheet" href="/styles/global.css">
  <script src="/components/site-header.js" type="module"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      margin: 0;
      font-size: 2.5em;
      font-weight: 300;
    }

    .header p {
      margin: 10px 0 0 0;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    .info-grid {
      display: grid;
      gap: 20px;
    }

    .info-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      border-left: 4px solid #667eea;
    }

    .info-section h3 {
      margin: 0 0 15px 0;
      color: #333;
      font-size: 1.2em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .info-table {
      width: 100%;
      border-collapse: collapse;
    }

    .info-table td {
      padding: 8px 0;
      border-bottom: 1px solid #e9ecef;
    }

    .info-table td:last-child {
      border-bottom: none;
    }

    .info-table td:first-child {
      font-weight: 600;
      color: #666;
      width: 40%;
    }

    .info-table td:last-child {
      color: #333;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 0.9em;
    }

    .loading {
      color: #999;
      font-style: italic;
    }

    .status-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 5px;
    }

    .status-online {
      background: #28a745;
    }

    .status-offline {
      background: #dc3545;
    }

    .refresh-btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 20px;
      transition: background 0.3s;
    }

    .refresh-btn:hover {
      background: #5a6fd8;
    }

    @media (max-width: 600px) {
      .info-table td:first-child {
        width: 50%;
      }

      .info-table td:last-child {
        font-size: 0.8em;
      }
    }
  </style>
</head>

<body>
  <site-header active-page="whoami"></site-header>

  <div class="container">
    <div class="header">
      <h1>User Information</h1>
      <p>Details about your current session and device</p>
    </div>

    <div class="content">
      <div class="info-grid">
        <div class="info-section">
          <h3>üåê Network Information</h3>
          <table class="info-table">
            <tr>
              <td>IP Address:</td>
              <td id="ip-address" class="loading">Detecting...</td>
            </tr>
            <tr>
              <td>Location:</td>
              <td id="location" class="loading">Detecting...</td>
            </tr>
            <tr>
              <td>ISP:</td>
              <td id="isp" class="loading">Detecting...</td>
            </tr>
            <tr>
              <td>Timezone:</td>
              <td id="timezone" class="loading">Detecting...</td>
            </tr>
          </table>
        </div>

        <div class="info-section">
          <h3>üñ•Ô∏è Browser Information</h3>
          <table class="info-table">
            <tr>
              <td>Browser:</td>
              <td id="browser">Detecting...</td>
            </tr>
            <tr>
              <td>Browser Version:</td>
              <td id="browser-version">Detecting...</td>
            </tr>
            <tr>
              <td>Engine:</td>
              <td id="engine">Detecting...</td>
            </tr>
            <tr>
              <td>Cookies Enabled:</td>
              <td id="cookies">Detecting...</td>
            </tr>
          </table>
        </div>

        <div class="info-section">
          <h3>üì± Device Information</h3>
          <table class="info-table">
            <tr>
              <td>Platform:</td>
              <td id="platform">Detecting...</td>
            </tr>
            <tr>
              <td>Device Type:</td>
              <td id="device-type">Detecting...</td>
            </tr>
            <tr>
              <td>Screen Resolution:</td>
              <td id="screen-resolution">Detecting...</td>
            </tr>
            <tr>
              <td>Color Depth:</td>
              <td id="color-depth">Detecting...</td>
            </tr>
            <tr>
              <td>Language:</td>
              <td id="language">Detecting...</td>
            </tr>
          </table>
        </div>

        <div class="info-section">
          <h3>üîó Connection Information</h3>
          <table class="info-table">
            <tr>
              <td>Online Status:</td>
              <td id="online-status">Detecting...</td>
            </tr>
            <tr>
              <td>Connection Type:</td>
              <td id="connection-type">Detecting...</td>
            </tr>
            <tr>
              <td>Page Load Time:</td>
              <td id="load-time">Detecting...</td>
            </tr>
          </table>
        </div>
      </div>

      <button class="refresh-btn" onclick="refreshData()">üîÑ Refresh Data</button>
    </div>
  </div>

  <script>
    // Browser detection
    function getBrowserInfo() {
      const ua = navigator.userAgent;
      let browserName = "Unknown";
      let browserVersion = "Unknown";
      let engine = "Unknown";

      if (ua.indexOf("Firefox") > -1) {
        browserName = "Firefox";
        browserVersion = ua.match(/Firefox\/(\d+)/)?.[1] || "Unknown";
        engine = "Gecko";
      } else if (ua.indexOf("Chrome") > -1 && ua.indexOf("Edg") === -1) {
        browserName = "Chrome";
        browserVersion = ua.match(/Chrome\/(\d+)/)?.[1] || "Unknown";
        engine = "Blink";
      } else if (ua.indexOf("Safari") > -1 && ua.indexOf("Chrome") === -1) {
        browserName = "Safari";
        browserVersion = ua.match(/Version\/(\d+)/)?.[1] || "Unknown";
        engine = "WebKit";
      } else if (ua.indexOf("Edg") > -1) {
        browserName = "Edge";
        browserVersion = ua.match(/Edg\/(\d+)/)?.[1] || "Unknown";
        engine = "Blink";
      }

      return { browserName, browserVersion, engine };
    }

    // Device type detection
    function getDeviceType() {
      const ua = navigator.userAgent;
      if (/tablet|ipad|playbook|silk/i.test(ua)) {
        return "Tablet";
      }
      if (/mobile|iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(ua)) {
        return "Mobile";
      }
      return "Desktop";
    }

    // Update browser and device info
    function updateLocalInfo() {
      const browserInfo = getBrowserInfo();

      document.getElementById('browser').textContent = browserInfo.browserName;
      document.getElementById('browser-version').textContent = browserInfo.browserVersion;
      document.getElementById('engine').textContent = browserInfo.engine;
      document.getElementById('cookies').textContent = navigator.cookieEnabled ? "Yes" : "No";
      document.getElementById('platform').textContent = navigator.platform || "Unknown";
      document.getElementById('device-type').textContent = getDeviceType();
      document.getElementById('screen-resolution').textContent = `${screen.width}x${screen.height}`;
      document.getElementById('color-depth').textContent = `${screen.colorDepth}-bit`;
      document.getElementById('language').textContent = navigator.language || "Unknown";

      // Online status
      const onlineStatus = document.getElementById('online-status');
      if (navigator.onLine) {
        onlineStatus.innerHTML = '<span class="status-indicator status-online"></span>Online';
      } else {
        onlineStatus.innerHTML = '<span class="status-indicator status-offline"></span>Offline';
      }

      // Connection type
      const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
      document.getElementById('connection-type').textContent = connection ? connection.effectiveType || "Unknown" : "Not available";

      // Page load time
      const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
      document.getElementById('load-time').textContent = loadTime > 0 ? `${loadTime}ms` : "Loading...";

      // Timezone
      const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
      document.getElementById('timezone').textContent = timezone || "Unknown";
    }

    // Fetch IP and location info
    async function fetchIpInfo() {
      try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();

        document.getElementById('ip-address').textContent = data.ip || "Unknown";
        document.getElementById('location').textContent = `${data.city || "Unknown"}, ${data.region || "Unknown"}, ${data.country_name || "Unknown"}`;
        document.getElementById('isp').textContent = data.org || "Unknown";
      } catch (error) {
        document.getElementById('ip-address').textContent = "Unavailable";
        document.getElementById('location').textContent = "Unavailable";
        document.getElementById('isp').textContent = "Unavailable";
      }
    }

    // Refresh all data
    function refreshData() {
      updateLocalInfo();
      fetchIpInfo();
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function () {
      updateLocalInfo();
      fetchIpInfo();

      // Listen for online/offline changes
      window.addEventListener('online', function () {
        document.getElementById('online-status').innerHTML = '<span class="status-indicator status-online"></span>Online';
      });

      window.addEventListener('offline', function () {
        document.getElementById('online-status').innerHTML = '<span class="status-indicator status-offline"></span>Offline';
      });
    });
  </script>
</body>

</html>